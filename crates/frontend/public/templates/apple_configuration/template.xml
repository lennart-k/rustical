<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>PayloadContent</key>
  <array>
    <dict>
      <key>CalDAVAccountDescription</key>
      <string>{{ user }}@{{ hostname }}</string>

      <key>CalDAVHostName</key>
      <string>{{ hostname }}</string>

      <key>CalDAVPrincipalURL</key>
      <string>https://{{ hostname }}/caldav-compat/principal/{{ user }}</string>

      <key>CalDAVUseSSL</key>
      <true/>

      <key>CalDAVUsername</key>
      <string>{{ user }}</string>

      <key>CalDAVPassword</key>
      <string>{{ token }}</string>

      <key>PayloadDescription</key>
      <string>{{ user }} RustiCal CalDAV profile</string>

      <key>PayloadDisplayName</key>
      <string>{{ user }} RustiCal CalDAV profile</string>

      <key>PayloadIdentifier</key>
      <string>{{ hostname }}.cal.{{ user }}</string>

      <key>PayloadOrganization</key>
      <string>RustiCal</string>

      <key>PayloadType</key>
      <string>com.apple.caldav.account</string>

      <key>PayloadUUID</key>
      <string>{{ uuid::Uuid::new_v4() }}</string>

      <key>PayloadVersion</key>
      <integer>1</integer>
    </dict>

    {% for membership in memberships %}
    <dict>
      <key>CalDAVAccountDescription</key>
      <string>{{ membership }}@{{ hostname }}</string>

      <key>CalDAVHostName</key>
      <string>{{ hostname }}</string>

      <key>CalDAVPrincipalURL</key>
      <string>https://{{ hostname }}/caldav-compat/principal/{{ membership }}</string>

      <key>CalDAVUseSSL</key>
      <true/>

      <key>CalDAVUsername</key>
      <string>{{ user }}${{ membership }}</string>

      <key>CalDAVPassword</key>
      <string>{{ token }}</string>

      <key>PayloadDescription</key>
      <string>{{ user }} (as {{ membership }}) RustiCal CalDAV profile</string>

      <key>PayloadDisplayName</key>
      <string>{{ user }} (as {{ membership }}) RustiCal CalDAV profile</string>

      <key>PayloadIdentifier</key>
      <string>{{ hostname }}.cal.{{ user }}.{{ membership }}</string>

      <key>PayloadOrganization</key>
      <string>RustiCal</string>

      <key>PayloadType</key>
      <string>com.apple.caldav.account</string>

      <key>PayloadUUID</key>
      <string>{{ uuid::Uuid::new_v4() }}</string>

      <key>PayloadVersion</key>
      <integer>1</integer>
    </dict>
    {% endfor %}

    <dict>
      <key>CardDAVAccountDescription</key>
      <string>{{ user }}@{{ hostname }}</string>

      <key>CardDAVHostName</key>
      <string>{{ hostname }}</string>

      <key>CardDAVPrincipalURL</key>
      <string>https://{{ hostname }}/carddav/principal/{{ user }}</string>

      <key>CardDAVUseSSL</key>
      <true/>

      <key>CardDAVUsername</key>
      <string>{{ user }}</string>

      <key>CardDAVPassword</key>
      <string>{{ token }}</string>

      <key>PayloadDescription</key>
      <string>{{ user }} RustiCal CardDAV profile</string>

      <key>PayloadDisplayName</key>
      <string>{{ user }} RustiCal CardDAV profile</string>

      <key>PayloadIdentifier</key>
      <string>{{ hostname }}.card.{{ user }}</string>

      <key>PayloadOrganization</key>
      <string>RustiCal</string>

      <key>PayloadType</key>
      <string>com.apple.carddav.account</string>

      <key>PayloadUUID</key>
      <string>{{ uuid::Uuid::new_v4() }}</string>

      <key>PayloadVersion</key>
      <integer>1</integer>

    </dict>
  </array>

  <key>PayloadDescription</key>
  <string>Set up your RustiCal CalDAV/CardDAV account for {{ user }}@{{ hostname }} with app token {{ token_name }}</string>

  <key>PayloadDisplayName</key>
  <string>RustiCal CalDAV/CardDAV</string>

  <key>PayloadIdentifier</key>
  <string>{{ hostname }}.{{ user }}</string>

  <key>PayloadOrganization</key>
  <string>{{ hostname }}</string>

  <key>PayloadRemovalDisallowed</key>
  <false/>

  <key>PayloadType</key>
  <string>Configuration</string>

  <key>PayloadUUID</key>
  <string>{{ uuid::Uuid::new_v4() }}</string>

  <key>PayloadVersion</key>
  <integer>1</integer>
</dict>
</plist>
